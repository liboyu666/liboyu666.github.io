<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é±¼å­ç»˜å›¾ Pro - Advanced AI Art Creation | Contact: 2116498608@qq.com</title>
    
    <!-- å¤–éƒ¨ä¾èµ– -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
        <style>
        :root {
            --primary-color: #94A684;    /* å¥¶æ²¹ç»¿ */
            --secondary-color: #E4E4D0;  /* æ·¡å¥¶æ²¹ */
            --accent-color: #AEC3AE;     /* æŸ”å’Œç»¿ */
            --background-color: #F5F5F5; /* çº¯å‡€ç™½ */
            --text-color: #4A4A4A;       /* æ¸©å’Œé»‘ */
            --border-radius: 12px;
            --shadow: 0 4px 20px rgba(0,0,0,0.05);
            --tab-height: 40px;
            --sidebar-width: 300px;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* å·¦ä¾§è¾¹æ  */
        .sidebar {
            width: var(--sidebar-width);
            background: white;
            border-right: 1px solid var(--secondary-color);
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
        }

        /* ä¸»å†…å®¹åŒº */
        .main-content {
            margin-left: var(--sidebar-width);
            flex: 1;
            padding: 20px;
            background: var(--background-color);
        }

        /* æ ‡ç­¾ç³»ç»Ÿ */
        .tab-container {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }

        .tab-header {
            display: flex;
            border-bottom: 1px solid var(--secondary-color);
            padding: 0 20px;
            overflow-x: auto;
            white-space: nowrap;
        }

        .tab-button {
            padding: 0 20px;
            height: var(--tab-height);
            line-height: var(--tab-height);
            border: none;
            background: none;
            cursor: pointer;
            color: var(--text-color);
            position: relative;
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            color: var(--primary-color);
            font-weight: 500;
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary-color);
        }

        /* å‚æ•°é¢æ¿ */
        .parameter-panel {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        /* è¾“å…¥åŒºåŸŸ */
        .prompt-textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 1px solid var(--secondary-color);
            border-radius: var(--border-radius);
            font-family: 'Inter', monospace;
            resize: vertical;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .prompt-textarea:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 2px rgba(148, 166, 132, 0.2);
        }

        /* å›¾ç‰‡ç”ŸæˆåŒºåŸŸ */
        .generation-area {
            border: 2px dashed var(--secondary-color);
            border-radius: var(--border-radius);
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
            margin-bottom: 20px;
            background: white;
        }

        .generation-area:hover {
            border-color: var(--primary-color);
            background: rgba(148, 166, 132, 0.05);
        }

        /* æŒ‰é’®æ ·å¼ */
        .action-button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            text-align: center;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .action-button:hover {
            background: var(--accent-color);
            transform: translateY(-1px);
        }

        .action-button i {
            font-size: 1.2em;
        }

        /* æ»‘å—æ ·å¼ */
        .range-slider {
            width: 100%;
            height: 4px;
            background: var(--secondary-color);
            border-radius: 2px;
            -webkit-appearance: none;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 0 0 1px var(--primary-color);
        }

        /* å›¾ç‰‡é¢„è§ˆ */
        .preview-container {
            position: relative;
            margin-top: 20px;
        }

        .preview-image {
            width: 100%;
            border-radius: var(--border-radius);
            display: none;
        }

        /* å·¥å…·æç¤º */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: rgba(0,0,0,0.8);
            color: white;
            text-align: center;
            padding: 5px;
            border-radius: 6px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* å†å²è®°å½• */
        .history-container {
            max-height: 400px;
            overflow-y: auto;
        }

        .history-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-radius: var(--border-radius);
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .history-item:hover {
            background: var(--secondary-color);
        }

        .history-thumbnail {
            width: 60px;
            height: 60px;
            border-radius: var(--border-radius);
            object-fit: cover;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <!-- çŠ¶æ€æç¤º -->
    <div id="status-badge" class="status-badge">
        <i class="bi bi-circle-fill"></i> <span id="status-text">å°±ç»ª</span>
    </div>

    <div class="app-container">
        <!-- å·¦ä¾§è¾¹æ  -->
        <div class="sidebar">
            <h4>ğŸ¨ é±¼å­ç»˜å›¾ Pro</h4>
            <p class="text-muted">Contact: 2116498608@qq.com</p>
            
            <!-- æ¨¡å‹ä¿¡æ¯ -->
            <div class="parameter-panel">
                <h6>å½“å‰æ¨¡å‹</h6>
                <select class="form-select mb-2" id="model-selector">
                    <option value="sdxl">Stable Diffusion XL</option>
                    <option value="sd15">Stable Diffusion 1.5</option>
                    <option value="anything5">Anything V5</option>
                    <option value="realistic">Realistic Vision V4</option>
                    <option value="anime">Animagine XL</option>
                </select>
                <div class="progress-container">
                    <div class="progress-bar" id="generation-progress"></div>
                </div>
            </div>

            <!-- VAEé€‰æ‹© -->
            <div class="parameter-panel">
                <h6>VAE æ¨¡å‹</h6>
                <select class="form-select" id="vae-selector">
                    <option value="default">é»˜è®¤ VAE</option>
                    <option value="kl-f8-anime2">kl-f8-anime2</option>
                    <option value="vae-ft-mse-840000">vae-ft-mse-840000</option>
                </select>
            </div>

            <!-- å¿«é€Ÿè®¾ç½® -->
            <div class="parameter-panel">
                <h6>å¿«é€Ÿè®¾ç½®</h6>
                <button class="action-button mb-2 w-100" onclick="applyPreset('highQuality')">
                    <i class="bi bi-stars"></i> é«˜è´¨é‡é¢„è®¾
                </button>
                <button class="action-button mb-2 w-100" onclick="applyPreset('fast')">
                    <i class="bi bi-lightning"></i> å¿«é€Ÿç”Ÿæˆ
                </button>
                <button class="action-button w-100" onclick="randomizeParams()">
                    <i class="bi bi-shuffle"></i> éšæœºå‚æ•°
                </button>
            </div>

            <!-- å†å²è®°å½• -->
            <div class="parameter-panel">
                <h6>ç”Ÿæˆå†å²</h6>
                <div id="history-list" class="history-container"></div>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒº -->
        <div class="main-content">
            <!-- æ ‡ç­¾é¡µ -->
            <div class="tab-container">
                <div class="tab-header">
                    <button class="tab-button active" data-tab="txt2img">æ–‡ç”Ÿå›¾</button>
                    <button class="tab-button" data-tab="img2img">å›¾ç”Ÿå›¾</button>
                    <button class="tab-button" data-tab="inpaint">å±€éƒ¨é‡ç»˜</button>
                    <button class="tab-button" data-tab="extras">åæœŸå¤„ç†</button>
                    <button class="tab-button" data-tab="settings">è®¾ç½®</button>
                </div>

                <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
                <div class="tab-content" id="tab-content">
                    <!-- æ–‡ç”Ÿå›¾é¢æ¿ -->
                    <div class="parameter-panel" id="txt2img-panel">
                        <!-- æç¤ºè¯åŒºåŸŸ -->
                        <div class="mb-4">
                            <label class="form-label">
                                æ­£å‘æç¤ºè¯
                                <span class="tooltip">
                                    <i class="bi bi-question-circle"></i>
                                    <span class="tooltip-text">æè¿°ä½ æƒ³è¦çš„å›¾ç‰‡å†…å®¹</span>
                                </span>
                            </label>
                            <textarea class="prompt-textarea" id="positive-prompt" 
                                    placeholder="masterpiece, best quality, ultra-detailed..."></textarea>

                            <label class="form-label">åå‘æç¤ºè¯</label>
                            <textarea class="prompt-textarea" id="negative-prompt" 
                                    placeholder="lowres, bad anatomy, text, watermark..."></textarea>
                        </div>

                        <!-- ç”Ÿæˆå‚æ•° -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">é‡‡æ ·æ–¹æ³•</label>
                                <select class="form-select" id="sampler">
                                    <option value="euler_a">Euler a</option>
                                    <option value="dpm++">DPM++ 2M Karras</option>
                                    <option value="dpm_sde">DPM++ SDE Karras</option>
                                    <option value="ddim">DDIM</option>
                                    <option value="unipc">UniPC</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">é‡‡æ ·æ­¥æ•°: <span id="steps-value">30</span></label>
                                <input type="range" class="range-slider" id="steps" 
                                       min="1" max="150" value="30">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">CFG Scale: <span id="cfg-value">7</span></label>
                                <input type="range" class="range-slider" id="cfg" 
                                       min="1" max="30" step="0.5" value="7">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Seed</label>
                                <div class="input-group">
                                    <input type="number" class="form-control" id="seed" value="-1">
                                    <button class="btn btn-outline-secondary" onclick="randomSeed()">
                                        <i class="bi bi-shuffle"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">å®½åº¦</label>
                                <select class="form-select" id="width">
                                    <option value="512">512px</option>
                                    <option value="768">768px</option>
                                    <option value="1024">1024px</option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">é«˜åº¦</label>
                                <select class="form-select" id="height">
                                    <option value="512">512px</option>
                                    <option value="768">768px</option>
                                    <option value="1024">1024px</option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">ç”Ÿæˆæ•°é‡</label>
                                <select class="form-select" id="batch-count">
                                    <option value="1">1å¼ </option>
                                    <option value="2">2å¼ </option>
                                    <option value="4">4å¼ </option>
                                </select>
                            </div>
                        </div>

                        <!-- ç”ŸæˆæŒ‰é’® -->
                        <div class="d-grid gap-2">
                            <button class="action-button" onclick="generateImage()">
                                <i class="bi bi-magic"></i> å¼€å§‹ç”Ÿæˆ
                            </button>
                        </div>
                    </div>

                    <!-- é¢„è§ˆåŒºåŸŸ -->
                    <div class="parameter-panel">
                        <h6>ç”Ÿæˆç»“æœ</h6>
                        <div id="preview-container" class="preview-container">
                            <img id="preview-image" class="preview-image">
                        </div>
                        <div id="batch-results" class="row mt-3"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
        <!-- JavaScript ä»£ç  -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // å…¨å±€é…ç½®
        const CONFIG = {
            apiEndpoints: {
                pollinations: 'https://image.pollinations.ai/prompt/',
                lexica: 'https://lexica.art/api/v1/search',
                prodia: 'https://api.prodia.com/v1/sd/generate'
            },
            presets: {
                highQuality: {
                    steps: 50,
                    cfgScale: 7,
                    sampler: 'dpm++',
                    width: 1024,
                    height: 1024,
                    model: 'sdxl'
                },
                fast: {
                    steps: 20,
                    cfgScale: 7,
                    sampler: 'euler_a',
                    width: 512,
                    height: 512,
                    model: 'sd15'
                }
            }
        };

        // çŠ¶æ€ç®¡ç†
        function showStatus(message, type = 'info') {
            const badge = document.getElementById('status-badge');
            const text = document.getElementById('status-text');
            text.textContent = message;
            badge.style.display = 'block';
            
            if (type === 'error') {
                badge.style.backgroundColor = 'rgba(220, 53, 69, 0.9)';
                badge.style.color = 'white';
            } else {
                badge.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
                badge.style.color = 'var(--text-color)';
            }
            
            if (type !== 'error') {
                setTimeout(() => {
                    badge.style.display = 'none';
                }, 3000);
            }
        }

        // æ ‡ç­¾é¡µåˆ‡æ¢
        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab-button');
            tabs.forEach(tab => {
                if (tab.dataset.tab === tabName) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });

            // æ›´æ–°å†…å®¹åŒºåŸŸ
            updateTabContent(tabName);
        }

        // æ›´æ–°æ ‡ç­¾é¡µå†…å®¹
        function updateTabContent(tabName) {
            const content = document.getElementById('tab-content');
            // è¿™é‡Œå¯ä»¥æ ¹æ®ä¸åŒçš„æ ‡ç­¾é¡µåç§°åŠ è½½ä¸åŒçš„å†…å®¹
            showStatus(`åˆ‡æ¢åˆ°${tabName}æ¨¡å¼`);
        }

        // åº”ç”¨é¢„è®¾
        function applyPreset(presetName) {
            const preset = CONFIG.presets[presetName];
            if (!preset) return;

            // åº”ç”¨é¢„è®¾å‚æ•°
            document.getElementById('steps').value = preset.steps;
            document.getElementById('steps-value').textContent = preset.steps;
            
            document.getElementById('cfg').value = preset.cfgScale;
            document.getElementById('cfg-value').textContent = preset.cfgScale;
            
            document.getElementById('sampler').value = preset.sampler;
            document.getElementById('width').value = preset.width;
            document.getElementById('height').value = preset.height;
            document.getElementById('model-selector').value = preset.model;

            showStatus(`å·²åº”ç”¨${presetName === 'highQuality' ? 'é«˜è´¨é‡' : 'å¿«é€Ÿ'}é¢„è®¾`);
        }

        // éšæœºç§å­
        function randomSeed() {
            document.getElementById('seed').value = Math.floor(Math.random() * 2147483647);
        }

        // æ›´æ–°è¿›åº¦æ¡
        function updateProgress(progress) {
            document.getElementById('generation-progress').style.width = `${progress}%`;
        }

        // å›¾ç‰‡ç”Ÿæˆä¸»å‡½æ•°
        async function generateImage() {
            showStatus('å‡†å¤‡ç”Ÿæˆ...');
            
            // æ”¶é›†å‚æ•°
            const params = {
                prompt: document.getElementById('positive-prompt').value,
                negative_prompt: document.getElementById('negative-prompt').value,
                model: document.getElementById('model-selector').value,
                sampler: document.getElementById('sampler').value,
                steps: parseInt(document.getElementById('steps').value),
                cfg_scale: parseFloat(document.getElementById('cfg').value),
                seed: document.getElementById('seed').value,
                width: document.getElementById('width').value,
                height: document.getElementById('height').value,
                batch_size: parseInt(document.getElementById('batch-count').value)
            };

            if (!params.prompt) {
                showStatus('è¯·è¾“å…¥æç¤ºè¯', 'error');
                return;
            }

            try {
                updateProgress(0);
                showStatus('æ­£åœ¨ç”Ÿæˆ...');

                // æ„å»ºAPIè¯·æ±‚
                const encodedPrompt = encodeURIComponent(
                    `${params.prompt} --no ${params.negative_prompt} ` +
                    `--w ${params.width} --h ${params.height} ` +
                    `--seed ${params.seed} --steps ${params.steps}`
                );

                // ä½¿ç”¨è½®è¯¢çš„æ–¹å¼è¯·æ±‚å¤šä¸ªAPI
                const images = [];
                for (let i = 0; i < params.batch_size; i++) {
                    updateProgress((i / params.batch_size) * 100);
                    
                    // æ·»åŠ æ—¶é—´æˆ³é¿å…ç¼“å­˜
                    const imageUrl = `${CONFIG.apiEndpoints.pollinations}${encodedPrompt}?t=${Date.now()}`;
                    images.push(imageUrl);
                    
                    // æ¨¡æ‹Ÿç”Ÿæˆå»¶è¿Ÿ
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }

                // æ˜¾ç¤ºç”Ÿæˆç»“æœ
                displayResults(images, params);
                
                updateProgress(100);
                showStatus('ç”Ÿæˆå®Œæˆï¼');
                
                // ä¿å­˜åˆ°å†å²è®°å½•
                saveToHistory(images[0], params);
                
            } catch (error) {
                console.error('Generation error:', error);
                showStatus('ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                updateProgress(0);
            }
        }

        // æ˜¾ç¤ºç”Ÿæˆç»“æœ
        function displayResults(images, params) {
            const container = document.getElementById('batch-results');
            container.innerHTML = '';
            
            images.forEach(url => {
                const col = document.createElement('div');
                col.className = 'col-md-6 col-lg-4 mb-3';
                col.innerHTML = `
                    <div class="card">
                        <img src="${url}" class="card-img-top" alt="ç”Ÿæˆçš„å›¾ç‰‡">
                        <div class="card-body">
                            <div class="btn-group w-100">
                                <button class="btn btn-outline-primary" onclick="downloadImage('${url}')">
                                    <i class="bi bi-download"></i>
                                </button>
                                <button class="btn btn-outline-primary" onclick="copyPrompt('${params.prompt}')">
                                    <i class="bi bi-clipboard"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(col);
            });

            // æ˜¾ç¤ºç¬¬ä¸€å¼ å›¾ç‰‡åœ¨é¢„è§ˆåŒº
            const previewImage = document.getElementById('preview-image');
            previewImage.src = images[0];
            previewImage.style.display = 'block';
        }

        // ä¿å­˜åˆ°å†å²è®°å½•
        function saveToHistory(imageUrl, params) {
            const history = JSON.parse(localStorage.getItem('imageHistory') || '[]');
            history.unshift({
                url: imageUrl,
                params: params,
                timestamp: new Date().toISOString()
            });
            localStorage.setItem('imageHistory', JSON.stringify(history.slice(0, 50)));
            updateHistoryDisplay();
        }

        // æ›´æ–°å†å²è®°å½•æ˜¾ç¤º
        function updateHistoryDisplay() {
            const history = JSON.parse(localStorage.getItem('imageHistory') || '[]');
            const container = document.getElementById('history-list');
            container.innerHTML = history.map(item => `
                <div class="history-item" onclick="loadHistoryItem(${JSON.stringify(item)})">
                    <img src="${item.url}" class="history-thumbnail" alt="å†å²è®°å½•ç¼©ç•¥å›¾">
                    <div class="history-info">
                        <small>${new Date(item.timestamp).toLocaleString()}</small>
                    </div>
                </div>
            `).join('');
        }

        // åŠ è½½å†å²è®°å½•é¡¹
        function loadHistoryItem(item) {
            document.getElementById('positive-prompt').value = item.params.prompt;
            document.getElementById('negative-prompt').value = item.params.negative_prompt;
            document.getElementById('steps').value = item.params.steps;
            document.getElementById('steps-value').textContent = item.params.steps;
            document.getElementById('cfg').value = item.params.cfg_scale;
            document.getElementById('cfg-value').textContent = item.params.cfg_scale;
            document.getElementById('seed').value = item.params.seed;
            document.getElementById('width').value = item.params.width;
            document.getElementById('height').value = item.params.height;
            
            showStatus('å·²åŠ è½½å†å²è®°å½•å‚æ•°');
        }

        // ä¸‹è½½å›¾ç‰‡
        function downloadImage(url) {
            const a = document.createElement('a');
            a.href = url;
            a.download = `generated-${Date.now()}.png`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        // å¤åˆ¶æç¤ºè¯
        function copyPrompt(prompt) {
            navigator.clipboard.writeText(prompt).then(() => {
                showStatus('æç¤ºè¯å·²å¤åˆ¶');
            });
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–æ ‡ç­¾é¡µ
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', () => {
                    switchTab(button.dataset.tab);
                });
            });

            // åˆå§‹åŒ–æ»‘å—å€¼æ˜¾ç¤º
            document.getElementById('steps').addEventListener('input', function() {
                document.getElementById('steps-value').textContent = this.value;
            });
            document.getElementById('cfg').addEventListener('input', function() {
                document.getElementById('cfg-value').textContent = this.value;
            });

            // åŠ è½½å†å²è®°å½•
            updateHistoryDisplay();
            
            // æ˜¾ç¤ºå°±ç»ªçŠ¶æ€
            showStatus('ç³»ç»Ÿå°±ç»ª');
        });
    </script>
</body>
</html>
